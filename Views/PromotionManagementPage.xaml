<?xml version="1.0" encoding="utf-8" ?>
<Page
    x:Class="POS_For_Small_Shop.Views.PromotionManagementPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:converter="using:POS_For_Small_Shop.Converters"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:form="using:POS_For_Small_Shop.Views.PromotionPopupForm"
    xmlns:local="using:POS_For_Small_Shop.Views"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:model="using:POS_For_Small_Shop.Data.Models"
    Background="{ThemeResource ApplicationPageBackgroundThemeBrush}"
    mc:Ignorable="d">

    <Page.Resources>
        <converter:PromotionStatusConverter x:Key="PromotionStatusConverter" />

        <DataTemplate x:Key="PromotionItemTemplate" x:DataType="model:Promotion">
            <Grid Padding="10" Background="{x:Bind Converter={StaticResource PromotionStatusConverter}, ConverterParameter=Stripe}">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="1*" />
                    <ColumnDefinition Width="2*" />
                    <ColumnDefinition Width="1.5*" />
                    <ColumnDefinition Width="100" />
                    <ColumnDefinition Width="1*" />
                    <ColumnDefinition Width="1.5*" />
                    <ColumnDefinition Width="150" />
                </Grid.ColumnDefinitions>

                <TextBlock
                    VerticalAlignment="Center"
                    Text="{x:Bind PromoID, Mode=OneWay}"
                    TextTrimming="CharacterEllipsis" />
                <TextBlock
                    Grid.Column="1"
                    VerticalAlignment="Center"
                    Text="{x:Bind PromoName, Mode=OneWay}"
                    TextTrimming="CharacterEllipsis"
                    TextWrapping="Wrap" />
                <TextBlock
                    Grid.Column="2"
                    VerticalAlignment="Center"
                    Text="{x:Bind Details.DiscountType, Mode=OneWay}"
                    TextTrimming="CharacterEllipsis" />
                <TextBlock
                    Grid.Column="3"
                    VerticalAlignment="Center"
                    Text="{x:Bind Details.DiscountValue, Mode=OneWay}"
                    TextTrimming="CharacterEllipsis" />
                <Border
                    Grid.Column="4"
                    Width="80"
                    Height="25"
                    Margin="5,0"
                    Background="{x:Bind Converter={StaticResource PromotionStatusConverter}, Mode=OneWay}"
                    CornerRadius="12">
                    <TextBlock
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center"
                        FontWeight="Bold"
                        Foreground="White"
                        Text="{x:Bind Converter={StaticResource PromotionStatusConverter}, ConverterParameter=Status, Mode=OneWay}"
                        TextTrimming="CharacterEllipsis" />
                </Border>
                <TextBlock
                    Grid.Column="5"
                    Margin="5,0"
                    VerticalAlignment="Center"
                    FontSize="14"
                    FontWeight="SemiBold"
                    Text="{x:Bind Converter={StaticResource PromotionStatusConverter}, ConverterParameter=TimeRemaining, Mode=OneWay}"
                    TextTrimming="CharacterEllipsis" />
                <StackPanel
                    Grid.Column="6"
                    HorizontalAlignment="Right"
                    Orientation="Horizontal"
                    Spacing="5">
                    <Button
                        Width="36"
                        Height="36"
                        Padding="0"
                        Background="LightBlue"
                        CornerRadius="4"
                        ToolTipService.Placement="Bottom"
                        ToolTipService.ToolTip="View Details">
                        <FontIcon Glyph="" />
                    </Button>
                    <Button
                        Width="36"
                        Height="36"
                        Padding="0"
                        Background="LightCoral"
                        CornerRadius="4"
                        ToolTipService.Placement="Bottom"
                        ToolTipService.ToolTip="Delete Promotion">
                        <FontIcon Glyph="" />
                    </Button>
                    <Button
                        Width="36"
                        Height="36"
                        Padding="0"
                        Background="LightGoldenrodYellow"
                        CornerRadius="4"
                        ToolTipService.Placement="Bottom"
                        ToolTipService.ToolTip="Update Promotion">
                        <FontIcon Glyph="" />
                    </Button>
                </StackPanel>
            </Grid>
        </DataTemplate>
    </Page.Resources>




    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <!--  Header with Breadcrumb  -->
            <RowDefinition Height="Auto" />
            <!--  Search and Filters  -->
            <RowDefinition Height="*" />
            <!--  Table  -->
            <RowDefinition Height="Auto" />
            <!--  Pagination  -->
        </Grid.RowDefinitions>

        <!--  Header with Breadcrumb  -->
        <StackPanel
            Grid.Row="0"
            Orientation="Horizontal"
            Spacing="5">
            <TextBlock
                FontSize="16"
                Foreground="Gray"
                Text="Home" />
            <TextBlock
                FontSize="16"
                Foreground="Gray"
                Text="&gt;" />
            <TextBlock
                FontSize="16"
                FontWeight="Bold"
                Text="Promotions" />
        </StackPanel>

        <Grid Grid.Row="1" Margin="0,10,0,10">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="Auto" />
            </Grid.ColumnDefinitions>

            <!--  Search and Filters Section  -->
            <Grid Grid.Column="0" Margin="0,0,20,0">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>

                <TextBox
                    Width="300"
                    MinWidth="200"
                    MaxWidth="400"
                    Margin="0,0,0,10"
                    HorizontalAlignment="Left"
                    CornerRadius="6"
                    PlaceholderText="Search by Promo Name" />

                <Expander
                    Grid.Row="1"
                    HorizontalAlignment="Left"
                    Header="Advanced Filters"
                    IsExpanded="False">
                    <StackPanel
                        MinWidth="300"
                        Margin="0,5,0,5"
                        Orientation="Vertical">
                        <ComboBox Margin="0,0,0,8" PlaceholderText="Select Discount Type">
                            <ComboBoxItem Content="Percentage" />
                            <ComboBoxItem Content="Fixed Amount" />
                            <ComboBoxItem Content="Buy One Get One" />
                        </ComboBox>
                        <TextBox
                            Margin="0,0,0,8"
                            CornerRadius="6"
                            PlaceholderText="Discount Value" />
                    </StackPanel>
                </Expander>
            </Grid>

            <!--  Button Section  -->
            <Button
                Grid.Column="1"
                MinWidth="140"
                Margin="10,0,0,0"
                Padding="12,6"
                HorizontalAlignment="Right"
                VerticalAlignment="Top"
                Background="#007A99"
                Click="AddPromotionButton_Click"
                Content="Add Promotion"
                CornerRadius="6"
                Foreground="White" />
        </Grid>


        <!--  Styled ListView (Striped Table with Dark Blue Header)  -->
        <ListView
            x:Name="DataListView"
            Grid.Row="2"
            IsItemClickEnabled="False"
            ItemTemplate="{StaticResource PromotionItemTemplate}"
            ItemsSource="{x:Bind ViewModel.Promotions, Mode=OneWay}"
            SelectionMode="None">
            <ListView.Header>
                <Grid Padding="10" Background="#003D57">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="1*" />
                        <ColumnDefinition Width="2*" />
                        <ColumnDefinition Width="1.5*" />
                        <ColumnDefinition Width="100" />
                        <ColumnDefinition Width="1*" />
                        <ColumnDefinition Width="1.5*" />
                        <ColumnDefinition Width="150" />
                    </Grid.ColumnDefinitions>

                    <TextBlock
                        HorizontalAlignment="Left"
                        VerticalAlignment="Center"
                        FontWeight="Bold"
                        Foreground="White"
                        Text="ID"
                        TextTrimming="CharacterEllipsis" />
                    <TextBlock
                        Grid.Column="1"
                        HorizontalAlignment="Left"
                        VerticalAlignment="Center"
                        FontWeight="Bold"
                        Foreground="White"
                        Text="Promotion Name"
                        TextTrimming="CharacterEllipsis" />
                    <TextBlock
                        Grid.Column="2"
                        HorizontalAlignment="Left"
                        VerticalAlignment="Center"
                        FontWeight="Bold"
                        Foreground="White"
                        Text="Discount Type"
                        TextTrimming="CharacterEllipsis" />
                    <TextBlock
                        Grid.Column="3"
                        HorizontalAlignment="Left"
                        VerticalAlignment="Center"
                        FontWeight="Bold"
                        Foreground="White"
                        Text="Value"
                        TextTrimming="CharacterEllipsis" />
                    <TextBlock
                        Grid.Column="4"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center"
                        FontWeight="Bold"
                        Foreground="White"
                        Text="Status"
                        TextTrimming="CharacterEllipsis" />
                    <TextBlock
                        Grid.Column="5"
                        HorizontalAlignment="Left"
                        VerticalAlignment="Center"
                        FontWeight="Bold"
                        Foreground="White"
                        Text="Time Remaining"
                        TextTrimming="CharacterEllipsis" />
                    <TextBlock
                        Grid.Column="6"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center"
                        FontWeight="Bold"
                        Foreground="White"
                        Text="Action"
                        TextTrimming="CharacterEllipsis" />
                </Grid>
            </ListView.Header>

            <ListView.ItemContainerStyle>
                <Style TargetType="ListViewItem">
                    <Setter Property="HorizontalContentAlignment" Value="Stretch" />
                    <Setter Property="BorderBrush" Value="LightGray" />
                    <Setter Property="BorderThickness" Value="0,0,0,1" />
                    <Setter Property="Padding" Value="0" />
                    <Setter Property="Margin" Value="0" />
                </Style>
            </ListView.ItemContainerStyle>
        </ListView>

        <!--  Pagination  -->
        <StackPanel
            Grid.Row="3"
            Margin="0,10,0,0"
            HorizontalAlignment="Center"
            Orientation="Horizontal"
            Spacing="10">
            <Button
                Padding="10,5"
                Content="Previous"
                CornerRadius="4" />
            <TextBlock VerticalAlignment="Center" Text="Page 1 of 10" />
            <Button
                Padding="10,5"
                Content="Next"
                CornerRadius="4" />
        </StackPanel>


        <Popup
            x:Name="addPromotionPopup"
            MaxWidth="800"
            MaxHeight="200"
            IsLightDismissEnabled="True"
            IsOpen="False">
            <form:AddPromotionForm x:Name="addPromotionForm" />
        </Popup>


    </Grid>
</Page>
